{% extends "base.html" %}

{% block title %}Inventory{% endblock %}
{% block header %}Raw Material Inventory{% endblock %}

{% block content %}
<div class="grid-container" style="grid-template-columns: 1fr 2fr;">
    <!-- Restock Form -->
    <div class="card">
        <h3>Restock Materials</h3>
        <form method="POST" action="{{ url_for('main.inventory') }}">
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #94a3b8;">Material</label>
                <select name="material_id" required
                    style="width: 100%; padding: 10px; background: #334155; border: 1px solid #475569; color: white; border-radius: 5px;">
                    {% for mat in raw_materials %}
                    <option value="{{ mat.id }}">{{ mat.name }} (Current: {{ mat.quantity }} {{ mat.unit }})</option>
                    {% endfor %}
                </select>
            </div>

            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #94a3b8;">Quantity to Add</label>
                <input type="number" step="0.01" name="quantity" min="0.1" required
                    style="width: 100%; padding: 10px; background: #334155; border: 1px solid #475569; color: white; border-radius: 5px;">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; color: #94a3b8;">Notes (Optional)</label>
                <input type="text" name="notes" placeholder="e.g., Supplier name, invoice number..."
                    style="width: 100%; padding: 10px; background: #334155; border: 1px solid #475569; color: white; border-radius: 5px;">
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;">Add Stock</button>
        </form>
    </div>

    <!-- Inventory List -->
    <div class="card">
        <h3>Current Stock Levels</h3>
        <div style="max-height: 500px; overflow-y: auto;">
            <table>
                <thead>
                    <tr>
                        <th>Material</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Price/Unit</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for mat in raw_materials %}
                    <tr>
                        <td style="font-weight: 500; color: var(--accent-color);">{{ mat.name }}</td>
                        <td style="font-weight: bold; color: white;">{{ "%.2f"|format(mat.quantity) }}</td>
                        <td style="color: #8b949e;">{{ mat.unit }}</td>
                        <td style="color: white;">‚Çπ{{ "%.2f"|format(mat.unit_price) }}</td>
                        <td>
                            {% if mat.quantity < 20 %} <span class="badge badge-danger">Low Stock</span>
                                {% elif mat.quantity < 50 %} <span class="badge"
                                    style="background: rgba(245, 158, 11, 0.1); color: #f59e0b; border: 1px solid rgba(245, 158, 11, 0.2);">
                                    Medium</span>
                                    {% else %}
                                    <span class="badge badge-success">Good</span>
                                    {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="card" style="margin-top: 30px;">
    <h3>Inventory Management Guide</h3>
    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; font-size: 0.9rem; color: #8b949e;">
        <div>
            <h4 style="color: var(--text-color); margin-bottom: 10px;">üìâ Automatic Deduction</h4>
            <p>Materials are automatically deducted every time a production run is logged in the Production module.</p>
        </div>
        <div>
            <h4 style="color: var(--text-color); margin-bottom: 10px;">üì¶ Restocking</h4>
            <p>Use the form above to add new stock. This will increase the current quantity and update the status
                indicator.</p>
        </div>
        <div>
            <h4 style="color: var(--text-color); margin-bottom: 10px;">‚ö†Ô∏è Low Stock Alerts</h4>
            <p>Materials with less than 20 units will be marked with a Red badge as a reminder to restock immediately.
            </p>
        </div>
    </div>
</div>
{% endblock %}
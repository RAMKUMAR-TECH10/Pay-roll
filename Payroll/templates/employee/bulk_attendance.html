{% extends "base.html" %}

{% block title %}Bulk Attendance{% endblock %}
{% block header %}Mark Bulk Attendance{% endblock %}

{% block content %}
<div class="container">
    <div class="card" style="margin-bottom: 30px;">
        <h3>üìÖ Select Date & Mark Attendance</h3>
        
        <form method="POST" action="{{ url_for('employee.bulk_attendance') }}">
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: var(--text-color); font-weight: 600;">
                    Attendance Date
                </label>
                <input type="date" name="date" value="{{ attendance_date }}" required
                    class="form-control form-control-lg"
                    onchange="document.location.href='{{ url_for('employee.bulk_attendance') }}?date=' + this.value;"
                    style="max-width: 300px;">
                <small style="color: var(--text-color); margin-top: 5px; display: block;">
                    Select a date to mark attendance for all employees on that date.
                </small>
            </div>

            <!-- Employees Grid -->
            <div style="background: var(--card-bg); border-radius: 12px; padding: 20px; margin-top: 20px;">
                <h4 style="margin-top: 0; color: var(--accent-color); margin-bottom: 20px;">
                    üë• Mark Attendance for {{ employees|length }} Employees
                </h4>

                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                    {% for emp in employees %}
                    <div style="padding: 15px; background: rgba(88, 166, 255, 0.05); border-radius: 8px; border: 1px solid var(--border-color);">
                        <!-- Employee Name Header -->
                        <div style="margin-bottom: 12px;">
                            <div style="font-weight: 600; color: var(--accent-color); font-size: 1rem;">
                                {{ emp.get_full_name() }}
                            </div>
                            <div style="font-size: 0.85rem; color: #8b949e;">
                                {{ emp.position }} ‚Ä¢ {{ emp.department }}
                            </div>
                        </div>

                        <!-- Status Selection -->
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="present" 
                                    {% if existing_attendance.get(emp.id, 'present') == 'present' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: var(--success-color); font-weight: 600;">‚úì Present</span>
                                </span>
                            </label>

                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="absent"
                                    {% if existing_attendance.get(emp.id) == 'absent' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: var(--danger-color); font-weight: 600;">‚úó Absent</span>
                                </span>
                            </label>

                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="late"
                                    {% if existing_attendance.get(emp.id) == 'late' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: #f59e0b; font-weight: 600;">‚è∞ Late</span>
                                </span>
                            </label>

                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="leave"
                                    {% if existing_attendance.get(emp.id) == 'leave' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: #8b949e; font-weight: 600;">üèñ Leave</span>
                                </span>
                            </label>

                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="sick"
                                    {% if existing_attendance.get(emp.id) == 'sick' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: #f85149; font-weight: 600;">ü§í Sick</span>
                                </span>
                            </label>

                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: var(--text-color);">
                                <input type="radio" name="status_{{ emp.id }}" value="half-day"
                                    {% if existing_attendance.get(emp.id) == 'half-day' %}checked{% endif %}
                                    style="cursor: pointer;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <span style="color: #58a6ff; font-weight: 600;">‚è± Half-Day</span>
                                </span>
                            </label>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Submit Button -->
            <div style="margin-top: 30px; display: flex; gap: 10px;">
                <button type="submit" class="btn btn-primary" style="flex: 1; padding: 15px; font-size: 1rem;">
                    ‚úÖ Confirm & Save Attendance
                </button>
                <a href="{{ url_for('employee.attendance_list') }}" class="btn" 
                    style="padding: 15px; background-color: var(--border-color); color: var(--text-color); border: 1px solid var(--border-color); border-radius: 10px; text-decoration: none; flex: 1; text-align: center;">
                    Cancel
                </a>
            </div>
        </form>
    </div>

    <!-- Instructions -->
    <div class="card" style="background: rgba(88, 166, 255, 0.05); border: 1px solid rgba(88, 166, 255, 0.2);">
        <h4 style="margin-top: 0; color: var(--accent-color);">üìã How to Use</h4>
        <ol style="color: var(--text-color); line-height: 1.8;">
            <li><strong>Select a Date:</strong> Use the date field at the top to choose which date to mark attendance for.</li>
            <li><strong>Mark Status:</strong> For each employee, select their attendance status (Present, Absent, Late, etc.).</li>
            <li><strong>Save:</strong> Click "Confirm & Save Attendance" to save all entries at once.</li>
            <li><strong>Edit:</strong> You can re-open this page and change statuses until you're happy with them.</li>
        </ol>
    </div>
</div>

<style>
    .container {
        max-width: 1400px;
        margin: 0 auto;
    }
</style>
{% endblock %}
